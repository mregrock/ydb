# Обзор конфигурации v2

Для развёртывания кластера {{ ydb-short-name }}, добавления в кластер новых узлов и изменения параметров требуется конфигурация.

{% note info %}

 Если ваш кластер {{ ydb-short-name }} развёрнут на более ранней версии, чем v25.1, обратитесь к [статье о конфигурации v1](../configuration-v1/index.md).

{% endnote %}

Конфигурация кластера {{ ydb-short-name }} представляет собой текст в формате YAML, интерпретация которого более подробно описана в статье [{#T}](../dynamic-config-selectors.md).

Конфигурация описывает настройки кластера {{ ydb-short-name }}. Конфигурационный файл содержит в себе различные параметры, необходимые для запуска и настройки узлов кластера. Подробнее о параметрах можно узнать в [справке по конфигурации](../../../reference/configuration/index.md). Часть параметров вступает в силу на узле сразу после того, как измененная конфигурация будет доставлена туда через CMS, а часть — только после перезапуска узла.

Конфигурация кластера {{ ydb-short-name }} хранится в нескольких разных местах:
- в виде файла первоначальной конфигурации узла в файловой системе каждого [узлах хранения](../../../concepts/glossary.md#storage-node) {{ ydb-short-name }} (необходим на случай отсутствия какой-либо другой конфигурации на момент запуска узла)
- в специальной области хранения метаданных на каждом PDisk (используется автоматической системой управления конфигурацией кластера для создания и применения новой конфигурации)
- в локальной базе таблетки Blob Storage Controller (используется для хранения полученной от пользователя конфигурации и управления ее распространением по кластеру)
- в локальной базе таблетки CMS (используется для распространения просмотра конфигурации и распространения ее в процессе работы по узлам кластера)
- в виде файла кэша конфигурации узла в файловой системе каждого узла {{ ydb-short-name }} (необходим для использования в момент запуска узла конфигурации, полученной ранее от CMS)

При [первоначальном развёртывании](../../deployment-options/manual/index.md) необходимо разместить конфигурационные файлы на всех [узлах хранения](../../../concepts/glossary.md#storage-node) по пути, указанному в параметре `ydbd --yaml-config`, запустить узлы кластера и затем передать этот же конфигурационный файл в систему автоматического управления конфигурацией кластера с помощью специальной команды. Система [распределённой конфигурации](../../../concepts/glossary.md#distributed-configuration.md) доставит эту конфигурацию на узлы кластера, сохранит копию в локальной директории на узлах, а также в Blob Storage Controller и CMS.

Для [обновления](#update-config) параметров необходимо так же передать модифицированный файл конфигурации в систему автоматического управления конфигурацией при помощи специальной команды. 

При [расширении кластера](../../../maintenance/manual/cluster_expansion.md) необходимо загрузить конфигурационный файл на кластер, с помощью специальной команды. На узлы, существовавшие до расширения, конфигурация будет доставлена автоматически системой [распределённой конфигурации](../../../concepts/glossary.md#distributed-configuration.md). На запускаемых впервые [узлах хранения](../../../concepts/glossary.md#storage-node) перед их первым запуском необходимо расместить конфигурационные файлы по пути, указанному в параметре `ydbd --yaml-config`.

## Базовые сценарии использования

### Первоначальное развёртывание кластера {{ ydb-short-name }} {#initial-deployment}

Для конфигурации кластера при первоначальном развёртывании необходимо воспользоваться соответствующими инструкциями в зависимости от предпочитаемого способа управления инфраструктурой:

- [Развёртывание с помощью Ansible](../../deployment-options/ansible/index.md);
- [Развёртывание вручную](../../deployment-options/manual/index.md).

### Обновление конфигурации {#update-config}

Для обновления конфигурации на уже развёрнутом кластере необходимо воспользоваться соответствующими командами в зависимости от способа развёртывания:

- [Обновление конфигурации для кластера, развёрнутого с помощью Ansible](../../deployment-options/ansible/update-config.md);
- [Обновление конфигурации для кластера, развёрнутого вручную](../../deployment-options/manual/update-config.md).

Если изменения конфигурации затрагивают параметры, требующие перезапуска узлов кластера, воспользуйтесь процедурой [rolling restart](../../../reference/ydbops/rolling-restart-scenario.md). Подробнее о ней в зависимости от способа развёртывания:

* [Перезапуск кластера, развёрнутого с помощью Ansible](../../deployment-options/ansible/restart.md);
* [Перезапуск кластера, развёрнутого вручную](../../../reference/ydbops/rolling-restart-scenario.md).

## Смотрите также

* [Добавление новых узлов в кластер](../../../maintenance/manual/cluster_expansion.md).
* [Справка по параметрам конфигурации](../../../reference/configuration/index.md).
